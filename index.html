<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é¤å»³ KPI æç›Šåˆ†æ</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">

  <div id="root" class="p-6"></div>

  <script type="text/babel">
    const { useState } = React;
    const { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, Legend } = Recharts;

    function KPIApp() {
      const [seatCount, setSeatCount] = useState(30);
      const [turnoverRate, setTurnoverRate] = useState(2);
      const [avgSpending, setAvgSpending] = useState(30);
      const [mode, setMode] = useState('monthly');

      const openDays = 30;
      const fixedCost = 40000;
      const grossMargin = 0.65;

      const dailyCustomer = seatCount * turnoverRate;
      const dailyRevenue = dailyCustomer * avgSpending;
      const monthlyRevenue = dailyRevenue * openDays;

      const revenue = mode === 'monthly' ? monthlyRevenue : dailyRevenue;
      const grossProfit = revenue * grossMargin;
      const netProfit = grossProfit - (mode === 'monthly' ? fixedCost : fixedCost / openDays);
      const breakevenRevenue = (mode === 'monthly' ? fixedCost : fixedCost / openDays) / grossMargin;

      const chartData = Array.from({ length: 31 }, (_, i) => {
        const rate = i + 1;
        const customers = seatCount * rate;
        const rev = customers * avgSpending * (mode === 'monthly' ? openDays : 1);
        const profit = rev * grossMargin - (mode === 'monthly' ? fixedCost : fixedCost / openDays);
        return {
          rate,
          revenue: Math.round(rev),
          profit: Math.round(profit),
          breakeven: Math.round(breakevenRevenue)
        };
      });

      return (
        <div className="max-w-5xl mx-auto bg-white rounded shadow p-6">
          <h1 className="text-2xl font-bold mb-4">ğŸ“Š é¤å»³ KPI æç›Šåˆ†æå·¥å…·</h1>

          {/* åˆ‡æ›æ¯æ—¥/æ¯æœˆ */}
          <div className="flex justify-end mb-4 space-x-2">
            <button
              onClick={() => setMode('daily')}
              className={`px-4 py-1 rounded ${mode==='daily' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}>
              æ¯æ—¥åˆ†æ
            </button>
            <button
              onClick={() => setMode('monthly')}
              className={`px-4 py-1 rounded ${mode==='monthly' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}>
              æ¯æœˆåˆ†æ
            </button>
          </div>

          {/* è¼¸å…¥å€ */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div>
              <label className="block font-medium">åº§ä½æ•¸</label>
              <input type="number" value={seatCount}
                onChange={(e) => setSeatCount(Number(e.target.value))}
                className="w-full border rounded px-2 py-1"/>
            </div>
            <div>
              <label className="block font-medium">ç¿»æ¡Œç‡ï¼ˆæ¯æ—¥ï¼‰</label>
              <input type="number" value={turnoverRate} step="0.1"
                onChange={(e) => setTurnoverRate(Number(e.target.value))}
                className="w-full border rounded px-2 py-1"/>
            </div>
            <div>
              <label className="block font-medium">å®¢å–®åƒ¹ ($)</label>
              <input type="number" value={avgSpending}
                onChange={(e) => setAvgSpending(Number(e.target.value))}
                className="w-full border rounded px-2 py-1"/>
            </div>
          </div>

          {/* KPI å€ */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div className="bg-gray-50 p-4 rounded border">
              <h2 className="text-lg font-semibold mb-2">ğŸ”¢ ç‡Ÿæ”¶èˆ‡ç›ˆè™§ï¼ˆ{mode === 'monthly' ? 'æ¯æœˆ' : 'æ¯æ—¥'}ï¼‰</h2>
              <p>é¡§å®¢æ•¸ï¼š<strong>{dailyCustomer}</strong></p>
              <p>ç‡Ÿæ”¶ï¼š<strong>${revenue.toFixed(0)}</strong></p>
              <p>æ¯›åˆ©ï¼ˆ65%ï¼‰ï¼š<strong>${grossProfit.toFixed(0)}</strong></p>
              <p>å›ºå®šæˆæœ¬ï¼š<strong>${(mode === 'monthly' ? fixedCost : fixedCost / openDays).toFixed(0)}</strong></p>
              <p>
                {netProfit >= 0 ? 'âœ… æ·¨åˆ©' : 'ğŸŸ¥ è™§æ'}ï¼š<strong>${netProfit.toFixed(0)}</strong>
              </p>
            </div>

            <div className="bg-gray-50 p-4 rounded border">
              <h2 className="text-lg font-semibold mb-2">âš–ï¸ æç›Šå¹³è¡¡ï¼ˆ{mode === 'monthly' ? 'æ¯æœˆ' : 'æ¯æ—¥'}ï¼‰</h2>
              <p>æç›Šå¹³è¡¡ç‡Ÿæ”¶ï¼š<strong>${breakevenRevenue.toFixed(0)}</strong></p>
              <p>æ‰€éœ€ç¿»æ¡Œç‡ï¼ˆæ‰“å¹³ï¼‰ï¼š<strong>{(breakevenRevenue / (seatCount * avgSpending)).toFixed(2)}</strong></p>
            </div>
          </div>

          {/* åœ–è¡¨ */}
          <div className="bg-gray-50 p-4 rounded border">
            <h2 className="text-lg font-semibold mb-4">ğŸ“ˆ ç¿»æ¡Œç‡ vs {mode === 'monthly' ? 'æ¯æœˆ' : 'æ¯æ—¥'}ç‡Ÿæ”¶ / åˆ©æ½¤</h2>
            <ResponsiveContainer width="100%" height={300}>
              <LineChart data={chartData}>
                <XAxis dataKey="rate" label={{ value: 'ç¿»æ¡Œç‡', position: 'insideBottom', dy: 10 }}/>
                <YAxis />
                <Tooltip />
                <Legend />
                <Line type="monotone" dataKey="revenue" stroke="#0ea5e9" name="ç‡Ÿæ”¶"/>
                <Line type="monotone" dataKey="breakeven" stroke="#f97316" name="æç›Šå¹³è¡¡ç‡Ÿæ”¶" strokeDasharray="5 5"/>
                <Line type="monotone" dataKey="profit" stroke="#10b981" name="æ·¨åˆ©"/>
              </LineChart>
            </ResponsiveContainer>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<KPIApp />);
  </script>

</body>
</html>
